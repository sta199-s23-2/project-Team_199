---
title: "Team 199: Olympics"
subtitle: "STA 199 Project"
format: html
editor: visual
---

```{r}

library(tidyverse)
library(tidymodels)
library(lubridate)

olympics <- read.csv("data/olympics.csv") 
glimpse(olympics)
```

```{r}

olympics_new <- olympics |> 
  mutate(BMI = (Weight/(Height/100)^2), medalyesno = if_else(is.na(Medal), "no", "yes"))

olympics_new <- as.data.frame(olympics_new)
  
```

```{r}

olympics_new |> 
  filter(Sport == "Gymnastics", medalyesno == "yes", Year > 1999) |>
  ggplot(aes(x = Team)) + 
    geom_bar()
```

```{r}

athlete_count_by_medal_status <- olympics |>
  summarise(count = n())



```

```{r}

olympians_per_team <- olympics |>
  group_by(Team) |>
  summarise(count = n()) |>
  arrange(desc(count))


N <- 20
top_n_teams <- olympians_per_team[1:N, ]


ggplot(top_n_teams, aes(x = Team, y = count)) +
  geom_col() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "Number of Olympians per Team (Top 20)",
       x = "Team",
       y = "Number of Olympians")


```

```{r}
olympians_per_games <- olympics |>
  group_by(Games) |>
  summarise(count = n()) |>
  arrange(Games)

ggplot(olympians_per_games, aes(x = Games, y = count)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(title = "Number of Olympians per Olympic Games",
       x = "Olympic Games",
       y = "Number of Olympians")


```

```{r}
olympians_per_sport <- olympics |>
  group_by(Sport) |>
  summarise(count = n()) |>
  arrange(desc(count))

```
